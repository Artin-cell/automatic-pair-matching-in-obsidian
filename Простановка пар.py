import os
import re
from pathlib import Path

def create_folders_and_files():
    # –ü—É—Ç—å –∫ —Ü–µ–ª–µ–≤–æ–π –ø–∞–ø–∫–µ
    base_path = Path(r"C:\Users\Oleg\Documents\–£—á–µ–±–∞\1 –î–∏—Å—Ü–∏–ø–ª–∏–Ω—ã\1 –∫—É—Ä—Å\2 —Å–µ–º–µ—Å—Ç—Ä\–ü—Ä–µ–¥–º–µ—Ç—ã")
    
    # –î–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
    subjects_data = [
        {"subject": "–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ (–ü–ó)", "teacher": "–ö–æ–ª–µ–∑–Ω–µ–≤–∞ –ö.–õ.", "lr": ""},
        {"subject": "–•–∏–º–∏—è (–õ–ï–ö–¶)", "teacher": "–ú–∞—Å–ª–∏–π –ê.–ù.", "lr": ""},
        {"subject": "–≠–ª–µ–∫—Ç–∏–≤–Ω—ã–µ –∫—É—Ä—Å—ã –ø–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∫—É–ª—å—Ç—É—Ä–µ –∏ —Å–ø–æ—Ä—Ç—É (–ü–ó)", "teacher": "–•–∞—Ä–∏–Ω–∞ –ê.–î.", "lr": ""},
        {"subject": "–í—ã—Å—à–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–õ–ï–ö–¶)", "teacher": "–ú–∏—Ö–µ–µ–≤ –ê.–í.", "lr": ""},
        {"subject": "–§–∏–∑–∏–∫–∞ (–õ–ï–ö–¶)", "teacher": "–ë—É—Ä–¥–æ–≤–∞ –ï.–í.", "lr": ""},
        {"subject": "–í—ã—Å—à–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–ü–ó)", "teacher": "–ú–∏—Ö–µ–µ–≤ –ê.–í.", "lr": ""},
        {"subject": "–ë–∏–±–ª–∏–æ–≥—Ä–∞—Ñ–∏—è –∏ –ø–∞—Ç–µ–Ω—Ç–æ–≤–µ–¥–µ–Ω–∏–µ (–ü–ó)", "teacher": "–ú–∞—Ä–∫–µ–ª–æ–≤ –ê.–ö.", "lr": ""},
        {"subject": "–ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞ (–õ–ï–ö–¶)", "teacher": "–í–∏—à–Ω—è–∫–æ–≤–∞ –ò.–í.", "lr": ""},
        {"subject": "–û–±—â–∞—è —Ö–∏–º–∏—á–µ—Å–∫–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è (–õ–ï–ö–¶)", "teacher": "–¢—É–Ω—Ü–µ–≤–∞ –°.–ù.", "lr": ""},
        {"subject": "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–æ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (–õ–ï–ö–¶)", "teacher": "–î–æ–≥–∞–¥–∫–∏–Ω –í.–ù.", "lr": ""},
        {"subject": "–ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞ (–õ–†)", "teacher": "–ú—É—Ö–∞–º–µ—Ç–∑—è–Ω–æ–≤–∞ –ê.–ì.", "lr": "1"},
        {"subject": "–û–±—â–∞—è —Ö–∏–º–∏—á–µ—Å–∫–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è (–õ–†)", "teacher": "–ë–∞–≥–∞–≤–µ–µ–≤ –ò.–ú.", "lr": "1"},
        {"subject": "–ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞ (–õ–†)", "teacher": "–í–∏—à–Ω—è–∫–æ–≤–∞ –ò.–í.", "lr": "1"},
        {"subject": "–§–∏–∑–∏–∫–∞ (–õ–†)", "teacher": "", "lr": "1"},
        {"subject": "–§–∏–∑–∏–∫–∞ (–õ–†)", "teacher": "", "lr": "1"},
        {"subject": "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–æ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (–õ–†)", "teacher": "–ê—Å–∫–∞—Ä–æ–≤–∞ –†.–ù.", "lr": "1"}
    ]
    
    # –®–∞–±–ª–æ–Ω —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ .md —Ñ–∞–π–ª–∞
    md_template = """---
course: 
semester: 
lecturer: [[{teacher}]]
tags: course
cabinet: 
contacts: 
min_score: 
attendance: 
---
### üìä –û—Ü–µ–Ω–∫–∏
- **–ú–∏–Ω–∏–º—É–º –¥–ª—è –∑–∞—á—ë—Ç–∞**: 
- **–û—Ç–ª–∏—á–Ω–æ**: 
- **–•–æ—Ä–æ—à–æ**: 
- **–ü—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª**: 

### üìÖ –ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –Ω–µ –º–µ–Ω–µ–µ % 

### üìö –ü—Ä–æ–≥—Ä–∞–º–º–∞
1. 
2. 
3. 

### ‚úèÔ∏è –ö–æ–Ω—Å–ø–µ–∫—Ç—ã –ª–µ–∫—Ü–∏–π
1. [[ ]]
2. [[ ]]
3. [[ ]]
4. [[ ]]

### üóìÔ∏è –î–µ–¥–ª–∞–π–Ω—ã
- [ ] –ó–∞–¥–∞–Ω–∏–µ: –¥–æ YYYY-MM-DD

### üìã –í–∏–¥—ã —Ä–∞–±–æ—Ç
- [ ] –†–∞—Å—á–µ—Ç–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
- [ ] –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
- [ ] –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
- [ ] –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
- [ ] –≠–∫–∑–∞–º–µ–Ω—ã

### üìñ –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞
- 

### üí° –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
- 
- 
- 
"""
    
    # –°–æ–∑–¥–∞–µ–º –±–∞–∑–æ–≤—É—é –ø–∞–ø–∫—É, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
    base_path.mkdir(parents=True, exist_ok=True)
    
    # –°—á–µ—Ç—á–∏–∫ –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω –ø–∞–ø–æ–∫ (–Ω–∞ —Å–ª—É—á–∞–π –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –Ω–∞–∑–≤–∞–Ω–∏–π)
    folder_counter = {}
    
    for item in subjects_data:
        subject_name = item["subject"]
        teacher = item["teacher"]
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π
        is_lab = item["lr"] == "1"
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞–ø–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ –ø—Ä–µ–¥–º–µ—Ç–∞
        if "(–õ–†)" in subject_name or is_lab:
            # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–º–µ—Ç–∫—É (–õ–†) –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
            if "(–õ–†)" not in subject_name:
                subject_name = f"{subject_name} (–õ–†)"
        
        # –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –ø–∞–ø–∫–∏ –¥–ª—è –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤
        if subject_name in folder_counter:
            folder_counter[subject_name] += 1
            folder_name = f"{subject_name} ({folder_counter[subject_name]})"
        else:
            folder_counter[subject_name] = 1
            folder_name = subject_name
        
        # –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ –ø—Ä–µ–¥–º–µ—Ç–∞
        subject_path = base_path / folder_name
        subject_path.mkdir(exist_ok=True)
        
        print(f"–°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞: {folder_name}")
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–¥–ø–∞–ø–∫–∏
        subfolders = ["–î–ó"]
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–∞–ø–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø—Ä–µ–¥–º–µ—Ç–∞
        if "(–õ–ï–ö–¶)" in subject_name:
            subfolders.append("–õ–µ–∫—Ü–∏–∏")
        if "(–ü–ó)" in subject_name:
            subfolders.append("–†–∞–±–æ—Ç—ã")
        if "(–õ–†)" in subject_name:
            subfolders.append("–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ")
            subfolders.append("–û—Ç—á–µ—Ç—ã")
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–¥–ø–∞–ø–∫–∏
        for subfolder in subfolders:
            subfolder_path = subject_path / subfolder
            subfolder_path.mkdir(exist_ok=True)
            print(f"  ‚Üí –°–æ–∑–¥–∞–Ω–∞ –ø–æ–¥–ø–∞–ø–∫–∞: {subfolder}")
        
        # –°–æ–∑–¥–∞–µ–º .md —Ñ–∞–π–ª
        md_file_path = subject_path / f"{folder_name}.md"
        
        # –ó–∞–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –≤ –∏–º–µ–Ω–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ)
        if teacher:
            teacher_display = teacher.replace('\n', ', ')
        else:
            teacher_display = ""
        
        # –ó–∞–ø–æ–ª–Ω—è–µ–º —à–∞–±–ª–æ–Ω –¥–∞–Ω–Ω—ã–º–∏
        md_content = md_template.format(teacher=teacher_display)
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ —Ñ–∞–π–ª
        with open(md_file_path, 'w', encoding='utf-8') as f:
            f.write(md_content)
        
        print(f"  ‚Üí –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª: {folder_name}.md")
    
    print("\n" + "="*50)
    print(f"–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"–í—Å–µ–≥–æ —Å–æ–∑–¥–∞–Ω–æ –ø–∞–ø–æ–∫: {len(folder_counter)}")
    print(f"–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: {base_path}")

if __name__ == "__main__":
    create_folders_and_files()